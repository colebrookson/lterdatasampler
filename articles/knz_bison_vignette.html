<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Konza Prairie Bison Weights (KNZ) • lterdatasampler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Konza Prairie Bison Weights (KNZ)">
<meta property="og:description" content="lterdatasampler">
<meta property="og:image" content="https://lter.github.io/lterdatasampler/reference/figures/leaf.png">
<meta property="og:image:alt" content="lterdatasampler package in R">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@allison_horst">
<meta name="twitter:site" content="@allison_horst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lterdatasampler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/and_vertebrates_vignette.html">Andrews Forest LTER Mack Creek cutthroat trout and salamanders (AND)</a>
    </li>
    <li>
      <a href="../articles/hbr_maples_vignette.html">Hubbard Brook Experimental Forest Sugar Maples (HBR)</a>
    </li>
    <li>
      <a href="../articles/knz_bison_vignette.html">Konza Prairie Bison Weights (KNZ)</a>
    </li>
    <li>
      <a href="../articles/ntl_icecover_vignette.html">North Temperate Lakes Ice Cover (NTL)</a>
    </li>
    <li>
      <a href="../articles/nwt_pikas_vignette.html">Niwot Ridge Pika Locations (NWT)</a>
    </li>
    <li>
      <a href="../articles/pie_crab_vignette.html">Plum Island Ecosystem LTER fiddler crabs (PIE)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lter/lterdatasampler/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="knz_bison_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Konza Prairie Bison Weights (KNZ)</h1>
            <h3 class="subtitle">Historical records of end-of-season weights for individual bison at Konza Prairie Biological Station LTER</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lter/lterdatasampler/blob/master/vignettes/knz_bison_vignette.Rmd"><code>vignettes/knz_bison_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>knz_bison_vignette.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>This data provides age and weight records for the bison herd at <a href="http://lter.konza.ksu.edu/konza-prairie-long-term-ecological-research-lter">Konza Prairie Biological Station LTER</a> in Kansas.</p>
<p>This vignette highlights:</p>
<ul>
<li>An example of modeling bison weight (as a function of age) using the Gompertz model with <code>nls</code>
</li>
<li>Use of the <code>broom</code> package to tidy up outputs of <code>nls</code> for easier use</li>
</ul>
<figure style="text-align:center;"><img src="../man/figures/knz_bison_img.jpg" width="80%" style="display:block; margin-left: auto; margin-right: auto;"><figcaption>
Konza Prairie LTER bison herd, LTER CC BY-SA 4.0
</figcaption></figure>
</div>
<div id="packages" class="section level1">
<h1 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lter/lterdatasampler">lterdatasampler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="data-exploration" class="section level1">
<h1 class="hasAnchor">
<a href="#data-exploration" class="anchor"></a>Data exploration</h1>
<p>Let’s take a look at the existing <code>knz_bison</code> data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">knz_bison</span>
<span class="co">#&gt; # A tibble: 8,325 × 8</span>
<span class="co">#&gt;    data_code rec_year rec_month rec_day animal_code animal_sex animal_weight</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt;  1 CBH01         1994        11       8 813         F                    890</span>
<span class="co">#&gt;  2 CBH01         1994        11       8 834         F                   1074</span>
<span class="co">#&gt;  3 CBH01         1994        11       8 B-301       F                   1060</span>
<span class="co">#&gt;  4 CBH01         1994        11       8 B-402       F                    989</span>
<span class="co">#&gt;  5 CBH01         1994        11       8 B-403       F                   1062</span>
<span class="co">#&gt;  6 CBH01         1994        11       8 B-502       F                    978</span>
<span class="co">#&gt;  7 CBH01         1994        11       8 B-503       F                   1068</span>
<span class="co">#&gt;  8 CBH01         1994        11       8 B-504       F                   1024</span>
<span class="co">#&gt;  9 CBH01         1994        11       8 B-601       F                    978</span>
<span class="co">#&gt; 10 CBH01         1994        11       8 B-602       F                   1188</span>
<span class="co">#&gt; # … with 8,315 more rows, and 1 more variable: animal_yob &lt;dbl&gt;</span></code></pre></div>
<p>We can calculate each bison’s age at observation by subtracting the year of birth from the record year (putting this in a new column using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">knz_bison_age</span> <span class="op">&lt;-</span> <span class="va">knz_bison</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>animal_age <span class="op">=</span> <span class="va">rec_year</span> <span class="op">-</span> <span class="va">animal_yob</span><span class="op">)</span></code></pre></div>
<p>Now, we’ll explore bison weight as a function of age (in years), separated by sex.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">knz_bison_age</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal_age</span>, y <span class="op">=</span> <span class="va">animal_weight</span>, group <span class="op">=</span> <span class="va">animal_sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">animal_sex</span><span class="op">)</span>, 
             size <span class="op">=</span> <span class="fl">0.5</span>,
             position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bison age"</span>,
       y <span class="op">=</span> <span class="st">"Recorded weight (pounds"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 252 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="knz_bison_vignette_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="gompertz-model-with-nonlinear-least-squares" class="section level1">
<h1 class="hasAnchor">
<a href="#gompertz-model-with-nonlinear-least-squares" class="anchor"></a>Gompertz model (with nonlinear least squares)</h1>
<p>As used by Martin and Barboza (2020), bison body mass as a function of age can be modeled using a sex-specific Gompertz model:</p>
<p><span class="math display">\[BM =b1*exp(-exp(-b2*(age-b3)))\]</span> Where <span class="math inline">\(b1\)</span> is the <em>asymptotic body mass</em> (pounds), <span class="math inline">\(b2\)</span> is instantaneous growth-rate at inflection point, and <span class="math inline">\(b3\)</span> is age at inflection point (years).</p>
<p>Using nonlinear least squares (nls) to estimate <span class="math inline">\(b1\)</span>, <span class="math inline">\(b2\)</span> and <span class="math inline">\(b3\)</span> requires starting estimates for each. We will use the following (based on visualizations above, and estimates from Supplemental Materials for Martin and Barbosa (2020):</p>
<div id="female-bison-parameter-initial-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#female-bison-parameter-initial-estimates" class="anchor"></a>Female bison parameter initial estimates:</h3>
<ul>
<li>
<span class="math inline">\(b1\)</span> initial estimate: 1000 pounds</li>
<li>
<span class="math inline">\(b2\)</span> initial estimate: 1</li>
<li>
<span class="math inline">\(b3\)</span> initial estimate: 0.6</li>
</ul>
</div>
<div id="create-the-gompertz-model-function" class="section level2">
<h2 class="hasAnchor">
<a href="#create-the-gompertz-model-function" class="anchor"></a>Create the Gompertz model function:</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gompertz</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span>, <span class="va">animal_age</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">b1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">b2</span><span class="op">*</span><span class="op">(</span><span class="va">animal_age</span><span class="op">-</span><span class="va">b3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="use-nls-to-model-growth-for-female-bison" class="section level2">
<h2 class="hasAnchor">
<a href="#use-nls-to-model-growth-for-female-bison" class="anchor"></a>Use <code>nls()</code> to model growth for female bison</h2>
<p>Isolate just the female bison (note that this starts from the dataset <code>knz_bison_age</code> created above that contains the calculated bison <strong>age</strong>, stored as <code>animal_age</code>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bison_f</span> <span class="op">&lt;-</span> <span class="va">knz_bison_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">animal_sex</span> <span class="op">==</span> <span class="st">"F"</span><span class="op">)</span></code></pre></div>
<p>Use <code>nls</code> to estimate parameters (note: add <code>trace = TRUE</code> to print iterative estimates):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bison_f_gompertz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">animal_weight</span> <span class="op">~</span> <span class="fu">gompertz</span><span class="op">(</span><span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span>, <span class="va">animal_age</span><span class="op">)</span>,
                        data <span class="op">=</span> <span class="va">bison_f</span>,
                        start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">1000</span>, b2 <span class="op">=</span> <span class="fl">1</span>, b3 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,
                        trace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 5.291715e+07 (7.61e-01): par = (1000 1 0.6)</span>
<span class="co">#&gt; 3.442663e+07 (1.91e-01): par = (1007.201 0.6930941 0.3444975)</span>
<span class="co">#&gt; 3.320797e+07 (7.02e-03): par = (1009.67 0.7250854 0.2798164)</span>
<span class="co">#&gt; 3.320631e+07 (1.28e-04): par = (1009.764 0.727529 0.2832794)</span>
<span class="co">#&gt; 3.320631e+07 (3.11e-06): par = (1009.756 0.7275973 0.2832921)</span></code></pre></div>
</div>
<div id="plot-the-predicted-masses-with-the-observed-data" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-the-predicted-masses-with-the-observed-data" class="anchor"></a>Plot the predicted masses with the observed data</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a new series of ages</span>
<span class="va">age_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">22</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>

<span class="co"># Make predictions using the model over those times: </span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bison_f_gompertz</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>animal_age <span class="op">=</span> <span class="va">age_series</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Bind the predictions and age sequence together into a data frame: </span>
<span class="va">bison_f_predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">age_series</span>, <span class="va">pred</span><span class="op">)</span>

<span class="co"># Plot the observed data and predictions together:</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bison_f</span>, 
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">animal_age</span>, y <span class="op">=</span> <span class="va">animal_weight</span><span class="op">)</span>,
             size <span class="op">=</span> <span class="fl">0.3</span>,
             alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bison_f_predicted</span>, 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_series</span>, y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"darkorchid"</span>,
            size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 236 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="knz_bison_vignette_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="explore-use-model-outputs-with-broom" class="section level1">
<h1 class="hasAnchor">
<a href="#explore-use-model-outputs-with-broom" class="anchor"></a>Explore &amp; use model outputs with <code>broom</code>
</h1>
<p>The wonderful <a href="https://broom.tidymodels.org/"><code>broom</code> package</a> “summarizes key information about models in tidy tibbles.” For example, the <code><a href="https://generics.r-lib.org/reference/tidy.html">broom::tidy()</a></code> function summarizes important model information:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Put model outputs into a tidy tibble: </span>
<span class="va">bison_f_gompertz_tidy</span> <span class="op">&lt;-</span> <span class="va">bison_f_gompertz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Check it out! </span>
<span class="va">bison_f_gompertz_tidy</span>
<span class="co">#&gt; # A tibble: 3 × 5</span>
<span class="co">#&gt;   term  estimate std.error statistic   p.value</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 b1    1010.      1.90        531.  0        </span>
<span class="co">#&gt; 2 b2       0.728   0.00755      96.4 0        </span>
<span class="co">#&gt; 3 b3       0.283   0.00806      35.1 4.76e-242</span></code></pre></div>
<p>We can also use the <code><a href="https://generics.r-lib.org/reference/glance.html">broom::glance()</a></code> function to return important information about the model overall:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bison_f_gompertz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 9</span>
<span class="co">#&gt;   sigma isConv     finTol  logLik    AIC    BIC  deviance df.residual  nobs</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;lgl&gt;       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1  81.1 TRUE   0.00000311 -29358. 58724. 58750. 33206307.        5046  5049</span></code></pre></div>
<p>We can use <code><a href="https://generics.r-lib.org/reference/augment.html">broom::augment()</a></code> to added fitted values and residuals to our <code>bison_f</code> data frame:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">bison_f_gompertz</span>, <span class="va">bison_f</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5,049 × 11</span>
<span class="co">#&gt;    data_code rec_year rec_month rec_day animal_code animal_sex animal_weight</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt;  1 CBH01         1994        11       8 813         F                    890</span>
<span class="co">#&gt;  2 CBH01         1994        11       8 834         F                   1074</span>
<span class="co">#&gt;  3 CBH01         1994        11       8 B-301       F                   1060</span>
<span class="co">#&gt;  4 CBH01         1994        11       8 B-402       F                    989</span>
<span class="co">#&gt;  5 CBH01         1994        11       8 B-403       F                   1062</span>
<span class="co">#&gt;  6 CBH01         1994        11       8 B-502       F                    978</span>
<span class="co">#&gt;  7 CBH01         1994        11       8 B-503       F                   1068</span>
<span class="co">#&gt;  8 CBH01         1994        11       8 B-504       F                   1024</span>
<span class="co">#&gt;  9 CBH01         1994        11       8 B-601       F                    978</span>
<span class="co">#&gt; 10 CBH01         1994        11       8 B-602       F                   1188</span>
<span class="co">#&gt; # … with 5,039 more rows, and 4 more variables: animal_yob &lt;dbl&gt;,</span>
<span class="co">#&gt; #   animal_age &lt;dbl&gt;, .fitted &lt;dbl&gt;, .resid &lt;dbl&gt;</span></code></pre></div>
<p><strong>Note:</strong> There are additional <a href="https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-knz.78.12">related datasets for this data package</a>, containing information for the number of male and female bison per age category and bison maternal parentage (calves matched to mother by ear tags). We encourage you to check them out for more analysis opportunities with the Konza Prairie bison!</p>
</div>
<div id="citations" class="section level1">
<h1 class="hasAnchor">
<a href="#citations" class="anchor"></a>Citations</h1>
<p>David Robinson, Alex Hayes and Simon Couch (2021). broom: Convert Statistical Objects into Tidy Tibbles. R package version 0.7.8. <a href="https://CRAN.R-project.org/package=broom" class="uri">https://CRAN.R-project.org/package=broom</a></p>
<p>Martin, JM and Barboza PS (2020). Decadal heat and drought drive body size of North American bison (Bison bison) along the Great Plains. Ecology and Evolution <em>10</em> (1): 336 - 349. <a href="https://doi.org/10.1002/ece3.5898" class="uri">https://doi.org/10.1002/ece3.5898</a>.</p>
</div>
<div id="how-we-processed-the-raw-data" class="section level1">
<h1 class="hasAnchor">
<a href="#how-we-processed-the-raw-data" class="anchor"></a>How we processed the raw data</h1>
<div id="download-the-raw-data-from-edi-org" class="section level3">
<h3 class="hasAnchor">
<a href="#download-the-raw-data-from-edi-org" class="anchor"></a>Download the raw data from EDI.org</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Attach packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org">usethis</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nceas/metajam">metajam</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="co"># Save link location for the data package:</span>
<span class="va">knz_url</span> <span class="op">&lt;-</span> <span class="st">"https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-knz.78.12&amp;entityid=0921d9c31d67badeb940f7352886134e"</span>

<span class="co"># Download the data package with metajam</span>
<span class="va">knz_download</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metajam/man/download_d1_data.html">download_d1_data</a></span><span class="op">(</span>data_url <span class="op">=</span> <span class="va">knz_url</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>, dir_name<span class="op">=</span><span class="st">"knz_bison"</span><span class="op">)</span>

<span class="co"># Read in data</span>
<span class="va">knz_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metajam/man/read_d1_files.html">read_d1_files</a></span><span class="op">(</span><span class="va">knz_download</span><span class="op">)</span></code></pre></div>
</div>
<div id="data-preparation" class="section level3">
<h3 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">knz_bison</span> <span class="op">&lt;-</span> <span class="va">knz_files</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">rec_type</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.allisonhorst.com/">Allison Horst</a>, <a href="https://brunj7.github.io/">Julien Brun</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
